{"title":"C++质数相关","uid":"a6b94d3de8f1fc6031ddcd36a585105b","slug":"C++质数相关","date":"2025-05-05T16:00:00.000Z","updated":"2025-05-27T11:35:48.000Z","comments":true,"path":"api/articles/C++质数相关.json","keywords":null,"cover":"https://cdn.luogu.com.cn/upload/image_hosting/fv11znvo.png","content":"<h1 id=\"1-判断质数\"><a href=\"#1-判断质数\" class=\"headerlink\" title=\"1.判断质数\"></a>1.判断质数</h1><h2 id=\"1-单一判断\"><a href=\"#1-单一判断\" class=\"headerlink\" title=\"1.单一判断\"></a>1.单一判断</h2><p>用作判断次数不多时使用。</p>\n<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D73A49\">bool</span><span style=\"color:#6F42C1\"> is_prime</span><span style=\"color:#24292E\">(</span><span style=\"color:#D73A49\">int</span><span style=\"color:#E36209\"> x</span><span style=\"color:#24292E\">)</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    if</span><span style=\"color:#24292E\">(x </span><span style=\"color:#D73A49\">&#x3C;=</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\">)</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#123;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        return</span><span style=\"color:#005CC5\"> 0</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    for</span><span style=\"color:#24292E\">(</span><span style=\"color:#D73A49\">int</span><span style=\"color:#24292E\"> i </span><span style=\"color:#D73A49\">=</span><span style=\"color:#005CC5\"> 2</span><span style=\"color:#24292E\"> ; i </span><span style=\"color:#D73A49\">*</span><span style=\"color:#24292E\"> i </span><span style=\"color:#D73A49\">&#x3C;=</span><span style=\"color:#24292E\"> x ; i </span><span style=\"color:#D73A49\">++</span><span style=\"color:#24292E\">)</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#123;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        if</span><span style=\"color:#24292E\">(x </span><span style=\"color:#D73A49\">%</span><span style=\"color:#24292E\"> i </span><span style=\"color:#D73A49\">==</span><span style=\"color:#005CC5\"> 0</span><span style=\"color:#24292E\">)</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        &#123;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">            return</span><span style=\"color:#005CC5\"> 0</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        &#125;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    return</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">&#125;</span></span></code></pre>\n\n<p>解释：我们把一个数拆成 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>×</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x \\times y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>，发现永远 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 小于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">n</span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span></span></span></span>，所以只要 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 不能整除 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><msqrt><mi>n</mi></msqrt></mrow><annotation encoding=\"application/x-tex\">\\le \\sqrt n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">n</span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span></span></span></span> 的整数，就是一个质数，提高了很多效率。但要注意，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n \\le 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 需单独处理。</p>\n<h2 id=\"2-埃氏筛法\"><a href=\"#2-埃氏筛法\" class=\"headerlink\" title=\"2.埃氏筛法\"></a>2.埃氏筛法</h2><p>当我们要进行多次判断时，就可能需要用到埃氏筛法。小学数学课讲过，放个图片应该就能理解。</p>\n<p><img src=\"https://pic1.imgdb.cn/item/6809d75f58cb8da5c8c84577.gif\"></p>\n<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#24292E\">isn_t_prime[</span><span style=\"color:#005CC5\">0</span><span style=\"color:#24292E\">] </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> isn_t_prime[</span><span style=\"color:#005CC5\">1</span><span style=\"color:#24292E\">] </span><span style=\"color:#D73A49\">=</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">for</span><span style=\"color:#24292E\">(</span><span style=\"color:#D73A49\">int</span><span style=\"color:#24292E\"> i </span><span style=\"color:#D73A49\">=</span><span style=\"color:#005CC5\"> 2</span><span style=\"color:#24292E\"> ; i </span><span style=\"color:#D73A49\">&#x3C;=</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#D73A49\">e</span><span style=\"color:#005CC5\">6</span><span style=\"color:#24292E\"> ; i </span><span style=\"color:#D73A49\">++</span><span style=\"color:#24292E\">)</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    if</span><span style=\"color:#24292E\">(isn_t_prime[i])</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#123;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        continue</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    for</span><span style=\"color:#24292E\">(</span><span style=\"color:#D73A49\">int</span><span style=\"color:#24292E\"> j </span><span style=\"color:#D73A49\">=</span><span style=\"color:#005CC5\"> 2</span><span style=\"color:#24292E\"> ; i </span><span style=\"color:#D73A49\">*</span><span style=\"color:#24292E\"> j </span><span style=\"color:#D73A49\">&#x3C;=</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#D73A49\">e</span><span style=\"color:#005CC5\">6</span><span style=\"color:#24292E\"> ; j </span><span style=\"color:#D73A49\">++</span><span style=\"color:#24292E\">)</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#123;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        isn_t_prime[i </span><span style=\"color:#D73A49\">*</span><span style=\"color:#24292E\"> j] </span><span style=\"color:#D73A49\">=</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">&#125;</span></span></code></pre>\n\n<p>解释：为了省去初始化数组全部为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的时间，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 才代表这是一个质数。碰到一个没达标记的数，就把它的倍数全部打上标记，重复标记是没问题的。但 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 要 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><msup><mn>10</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\le 10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span>，不然容易超时，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≥</mo><msup><mn>10</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">n \\ge 10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span> 时，还是用方法一较为合适。</p>\n<script src=\"https://giscus.app/client.js\"\n        data-repo=\"zhangyimin12345/zhangyimin12345.github.io\"\n        data-repo-id=\"R_kgDOOwy34Q\"\n        data-category=\"General\"\n        data-category-id=\"DIC_kwDOOwy34c4Cqo4M\"\n        data-mapping=\"pathname\"\n        data-strict=\"0\"\n        data-reactions-enabled=\"1\"\n        data-emit-metadata=\"0\"\n        data-input-position=\"top\"\n        data-theme=\"preferred_color_scheme\"\n        data-lang=\"zh-CN\"\n        crossorigin=\"anonymous\"\n        async>\n</script>","text":"1.判断质数1.单一判断用作判断次数不多时使用。 bool is_prime(int x) { if(x <= 1) { return 0; } for(int...","permalink":"/post/C++质数相关","photos":[],"count_time":{"symbolsCount":848,"symbolsTime":"1 mins."},"categories":[{"name":"C++","slug":"C","count":6,"path":"api/categories/C.json"}],"tags":[{"name":"OI","slug":"OI","count":7,"path":"api/tags/OI.json"},{"name":"语法","slug":"语法","count":4,"path":"api/tags/语法.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#1-%E5%88%A4%E6%96%AD%E8%B4%A8%E6%95%B0\"><span class=\"toc-text\">1.判断质数</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E5%8D%95%E4%B8%80%E5%88%A4%E6%96%AD\"><span class=\"toc-text\">1.单一判断</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E5%9F%83%E6%B0%8F%E7%AD%9B%E6%B3%95\"><span class=\"toc-text\">2.埃氏筛法</span></a></li></ol></li></ol>","author":{"name":"CodeNebula","slug":"blog-author","avatar":"https://cdn.luogu.com.cn/upload/image_hosting/dsfhfazq.png","link":"/","description":"Take a tour of 『CodeNebula』| 在『代码星云』里遨游。","socials":{"github":"https://github.com/zhangyimin12345","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"C++进制转换相关","uid":"92b0566789a1e5e04caf849ecf111b35","slug":"C++进制转换相关","date":"2025-05-05T16:00:00.000Z","updated":"2025-05-27T11:36:12.000Z","comments":true,"path":"api/articles/C++进制转换相关.json","keywords":null,"cover":"https://cdn.luogu.com.cn/upload/image_hosting/fv11znvo.png","text":"自带 注意 只有 oct，八进制 dec，十进制 hex，十六进制 代码 # include <bits/stdc++.h> using namespace s...","permalink":"/post/C++进制转换相关","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"C++","slug":"C","count":6,"path":"api/categories/C.json"}],"tags":[{"name":"OI","slug":"OI","count":7,"path":"api/tags/OI.json"},{"name":"语法","slug":"语法","count":4,"path":"api/tags/语法.json"}],"author":{"name":"CodeNebula","slug":"blog-author","avatar":"https://cdn.luogu.com.cn/upload/image_hosting/dsfhfazq.png","link":"/","description":"Take a tour of 『CodeNebula』| 在『代码星云』里遨游。","socials":{"github":"https://github.com/zhangyimin12345","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{}}